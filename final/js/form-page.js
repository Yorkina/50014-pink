!function(){function e(e,t){var n=new XMLHttpRequest,r=(new Date).getTime();n.open("post","http://simonenko.ru/academy/echo"+r,!0),n.addEventListener("readystatechange",function(){4==n.readyState&&t(n.responseText)}),n.send(e)}function t(e){if(e.type.match(/image.*/)){var t=new FileReader;t.addEventListener("load",function(t){var n=document.createElement("figure"),r=document.createElement("img"),a=document.createElement("a"),i=document.createElement("figcaption");r.src=t.target.result,r.alt=e.name,a.classList.add("travel-photo__btn-cancel"),a.innerHTML="&times;",a.href="#",i.innerHTML=e.name.toUpperCase(),l.appendChild(n),n.appendChild(r),n.appendChild(a),n.appendChild(i),a.addEventListener("click",function(e){e.preventDefault(),this.parentNode.remove()})}),t.readAsDataURL(e)}}function n(e){var t=0,n=document.querySelector(e.wrap);this.init=function(e){t=+e,n.innerHTML="";for(var r=1;t>=r;r++){var a=i(r);n.innerHTML+=a}l()},this.change=function(e){var e=+e;return e!=t?e>t?r(e):a(e):!1};var r=function(e){if(t=+e,n.children.length<t){var r=i(t);n.innerHTML+=r,l()}},a=function(e){t=+e,n.lastChild.remove()},i=function(e){var e=+e,t='<div class="travelers__row">                            <div class="travelers__names">                                <header>                                    <span>№</span>                                    <label for="traveler-name">Имя:                                        <sup>*</sup>                                    </label>                                </header>                                <span class="travelers__form-number">'+e+'</span>                                <input type="text" name="traveler-name['+e+']" tabindex="13" value="" placeholder="Введите ваше имя" required>                                <button class="travelers__name--delete">Удалить</button>                            </div>                            <div class="travelers__nick">                                <label for="traveler-nick">Прозвище:</label>                                <input type="text" name="traveler-nick['+e+']" tabindex="13" value="" placeholder="Ну как же без этого!" required>                            </div>                        </div>';return t},l=function(){for(var r=n.querySelectorAll("button.travelers__name--delete"),a=r.length-1;a>=0;a--)r[a].addEventListener("click",function(r){r.preventDefault(),this.parentNode.parentNode.remove(),t=+n.children.length,e.counter.value=t,t>0&&o(t)})},o=function(e){for(var t=n.children,r=0,a=1;r<=t.length-1,e>=a;r++,a++)t[r].querySelector(".travelers__form-number").innerText=a,t[r].querySelector(".travelers__names input[type=text]").name="traveler-name["+a+"]",t[r].querySelector(".travelers__nick input[type=text]").name="traveler-nick["+a+"]"}}function r(e){function t(){0!=i.value&&(i.value=+i.value-1)}function r(){i.value!=l&&(i.value=+i.value+1)}var a=document.querySelector(e.wrap),i=document.querySelector(e.box),l=+e.max>0?+e.max:365,o=e.travelersBox?new n({wrap:e.travelersBox,counter:i}):!1,u=this;a.addEventListener("click",function(a){a.preventDefault(),a.target.className==e.minus?t():a.target.className==e.plus&&r(),o instanceof n&&o.change(i.value)}),i.oninput=function(e){var t=/^[^A-Za-zА-Яа-я/]+$/g;return this.value.match(t)?void u.setCount(+this.value):void(this.value=this.value.replace(/[A-Za-zА-Яа-я]+/,""))},this.setCount=function(e){i.value=0>+e?0:l>=+e?+e:l,o instanceof n&&o.init(i.value)}}if("FormData"in window){var a=document.querySelector(".form-content__form");if(a.addEventListener("submit",function(t){t.preventDefault();var n=new FormData(a);e(n,function(e){console.log(e)})}),"FileReader"in window){var i=document.querySelector(".travel-photo"),l=document.querySelector(".travel-photo__images");i.querySelector("#upload__photo").addEventListener("change",function(){for(var e=this.files,n=0;n<e.length;n++)t(e[n])})}var o=new r({wrap:".trip-date-wrapper",box:".travel-duration__trip-date",minus:"travel-duration__btn-minus",plus:"travel-duration__btn-plus"});o.setCount(0);var u=new r({wrap:".travelers__count",box:".travelers__trip-count",minus:"travelers__btn-minus",plus:"travelers__btn-plus",max:9,travelersBox:".travelers__info-form"});u.setCount(2);var c=document.querySelector(".failure-popup"),s=c.querySelector(".failure-popup__button");s.addEventListener("click",function(e){e.preventDefault(),c.classList.add("failure-popup--hidden")});var v=document.querySelector(".request-popup"),d=v.querySelector(".request-popup__button");d.addEventListener("click",function(e){e.preventDefault(),v.classList.add("request-popup--hidden")})}}();